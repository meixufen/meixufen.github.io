<!DOCTYPE HTML>
<html>
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable"  content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no">
    <link rel="dns-prefetch" href="//t11.baidu.com">
    <!--SEO-->



<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>php+ajax+session判断用户登录状态 | 渣渣媛想学习</title>


    <link rel="alternate" href="/atom.xml" title="渣渣媛想学习" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    




    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css?rev=9.12.0">


<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    


    
    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?31521d39d9a65e0b8c58c2ceecee2d2c";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

</head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header">
    <div class="main-header-box">
        <a class="branding" href="/" title="">
            <img src="/img/header_logo.png" alt="Snippet 博客主题">
        </a>
        <h2 class="text-hide">Snippet主题</h2>
        <img src="/img/header_logo.png" alt="Snippet 博客主题" class="hide">
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only">Toggle navigation</span>
                    <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class=""><a href="/">Home</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/技术/">技术</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/随感/">随感</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/旅游/">旅游</a></li>
                        
                            <li role="presentation" class=""><a href="https://github.com/meixufen">github</a></li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="php+ajax+session判断用户登录状态">
            
            php+ajax+session判断用户登录状态
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <span>技术</span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            php ajax session 判断登录状态
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">2017/10/23</span>
    </span>
</div>

            
            
    </div>
    
    <div class="post-body">
        <h4 id="PHP-JS-AJAX-session判断用户登录状态"><a href="#PHP-JS-AJAX-session判断用户登录状态" class="headerlink" title="PHP+JS+AJAX+session判断用户登录状态"></a>PHP+JS+AJAX+session判断用户登录状态</h4><p>目的：对于没有登录的用户不能访问某些页面。<br><br>步骤：   <br></p>
<ol>
<li>登录页面logintest.html上用户填写用户名，密码，发送至后台，后台创建session变量表明登录成功：<br><br>前端登录页面：<br><br><img src="/images/ajax+php/1.png" alt=""></li>
</ol>
<p>在提交表单时，访问后台PHP，创建session变量：<br><br><img src="/images/ajax+php/2.png" alt=""></p>
<p>该checklogin.php文件中：   <br><br><img src="/images/ajax+php/3.png" alt=""></p>
<p>蓝框内代码创建变量，红框内代码在验证成功时赋值变量，注意必须有session_start();语句。该php表示：用户名密码正确时页面跳转至test.html。<br></p>
<ol>
<li>操作页面test.html上使用JS向后台进行查询，如果变量存在即表示用户状态为登录，可以访问，否则不能访问，可跳转至登录页面。</li>
</ol>
<p>页面引用test.js文件，该js文件向后台test.php进行状态查询；</p>
<p>该test.php文件中查询session对象，如果存在且为true表示用户已登录：<br><br><img src="/images/ajax+php/4.png" alt=""></p>
<p>如果存在即返回code=200；</p>
<p>前端JS接收值，如果为200表示用户登录，其余表示未登录：<br><br><img src="/images/ajax+php/5.png" alt=""></p>
<p>至此判断用户状态完成！<br><br>用户在登录页面登录成功后页面跳转到test.html：<br><br><img src="/images/ajax+php/6.png" alt=""></p>
<p>此时新开tab页直接访问该test.html页面得到上图一样的结果。</p>
<p>但在浏览器中清除缓存后再次访问该页面，得到结果即：<br><br><img src="/images/ajax+php/7.png" alt=""></p>
<p>因为账户未登录，导致访问失败。</p>
<p>用户退出时只需要删除session变量即可：<br>代码：<br>session_start();<br>unset($_session[‘xxx’]);<br>session_destroy();<br>变量成功删除后再检测该变量即为空，表示未登录。</p>
<p>遇到问题：</p>
<p>1.一开始为了方便，直接将php文件包含在html中，但是由于服务器未配置，导致php代码会被直接注释，无法起作用。</p>
<p>2.将所有文件都放在webstorm打开时，由于webstorm的配置问题，会导致页面表单中使用action时，会直接下载该php文件。<br>3.尝试直接在php文件中使用header语句：header (“Location:test.html”) ;进行页面跳转，但是用Ajax方式提交的页面，这时候PHP是没办法控制页面跳转的，只能是Js获取到页面的返回值，然后通过Js来跳转页面。</p>
<p>虽然看似简单，但是因为基础较差，还需要看似不那么难的3个问题，导致搞了一天才把功能实现，也是够醉！！</p>
<p>源代码下载链接：<a href="https://github.com/meixufen/php-ajax-session-" target="_blank" rel="external">https://github.com/meixufen/php-ajax-session-</a></p>

    </div>

    <div class="post-footer">   
        <div>
            
                转载声明: 商业转载请联系作者获得授权,非商业转载请注明出处 © Snippet
            
        </div>
        <div>
            
                License: <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">
知识共享署名-非商业性使用-禁止演绎 3.0 未本地化版本许可协议（CC BY-NC-ND 3.0）
</a>
            
        </div>  
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2017/11/06/tech/paper11-4/" class="pre-post btn btn-default"><i class="fa fa-angle-left fa-fw"></i>上一篇</a>
    
    
        <a href="/2017/09/16/emotion/September/" class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a>
    
</div>


    <div id="comments">
        
    <div id="uyan_frame"></div>
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>








    </div>





                </main>
                
    <aside class="col-md-4 sidebar">
        
        
    <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>个人的第一个博客，成立不久，后续慢慢添加，欢迎交流：bWVpeHVmZW5Ad2h1LmVkdS5jbg==<br>
        </div>
    </div>

        
        
    <div class="widget">
        <h3 class="title">Categories</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link current" href="/categories/技术/"><i class="fa" aria-hidden="true">技术</i></a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/旅游/"><i class="fa" aria-hidden="true">旅游</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随感/"><i class="fa" aria-hidden="true">随感</i></a><span class="category-list-count">2</span></li></ul>
    </div>


        
        
    <div class="widget">
      <h3 class="title">Archives</h3>
        <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/"><i class="fa" aria-hidden="true">May 2018</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/"><i class="fa" aria-hidden="true">December 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/"><i class="fa" aria-hidden="true">November 2017</i></a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/"><i class="fa" aria-hidden="true">October 2017</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/"><i class="fa" aria-hidden="true">September 2017</i></a><span class="archive-list-count">4</span></li></ul>
    </div>


        
        
  <div class="widget">
    <h3 class="title">Tag Cloud</h3>
    <div class="content tag-cloud">
      
        <a href="undefinedtags/nginx/" style="font-size: 1em;">nginx</a> <a href="undefinedtags/机器学习-句子相似性-词袋模型-gensim/" style="font-size: 1em;">机器学习 句子相似性 词袋模型 gensim</a> <a href="undefinedtags/半生缘-张爱玲/" style="font-size: 1em;">半生缘 张爱玲</a> <a href="undefinedtags/诗/" style="font-size: 1em;">诗</a> <a href="undefinedtags/扩展/" style="font-size: 1em;">扩展</a> <a href="undefinedtags/挖矿/" style="font-size: 1em;">挖矿</a> <a href="undefinedtags/游记/" style="font-size: 1em;">游记</a> <a href="undefinedtags/制作博客/" style="font-size: 1em;">制作博客</a> <a href="undefinedtags/nginx-服务器配置/" style="font-size: 1em;">nginx 服务器配置</a> <a href="undefinedtags/阅读论文/" style="font-size: 1em;">阅读论文</a> <a href="undefinedtags/PHP-安全登录-RSA/" style="font-size: 1em;">PHP 安全登录 RSA</a> <a href="undefinedtags/php-ajax-session-判断登录状态/" style="font-size: 1em;">php ajax session 判断登录状态</a> <a href="undefinedtags/谷歌-账号注册/" style="font-size: 1em;">谷歌 账号注册</a>
    </div>
  </div>


        
        
    <div class="widget">
        <h3 class="title">Friends</h3>
        <div class="content friends-link">
        
            <a href="http://meixufen.github.io" class="fa" target="_blank">我的github</a>
        
        </div>
    </div>


        
    </aside>

            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>






    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2017 
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>

  <script src="/assets/highlight.pack.js?rev=@@hash"></script>
  <script>
    hljs.initHighlightingOnLoad(); //初始化代码高亮 
  </script>

<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>